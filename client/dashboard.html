<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Manager v2.1 - Dashboard</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/complex-nodes.css">
    <link rel="stylesheet" href="css/themes.css">
</head>
<body data-theme="dark">
    
    <!-- Loading Overlay -->
    <div class="loading" id="loadingOverlay">
        <div class="spinner"></div>
        <p>Carregant...</p>
    </div>
    
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>
    
    <!-- Main Dashboard -->
    <div class="dashboard">
        
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1 class="logo">ğŸ“‹ Project Manager v2.1</h1>
                
                <!-- PROJECT SELECTOR -->
                <div class="project-selector">
                    <label for="projectSelect">Projecte:</label>
                    <select class="form-control" id="projectSelect">
                        <option value="">Carregant...</option>
                    </select>
                    <button class="btn btn-icon" id="btnNewProject" title="Crear nou projecte">
                        â•
                    </button>
                </div>
                
                <div class="version-info" id="versionInfo">
                    <span class="version-badge">
                        ğŸ¤– Claude: <strong id="vClaude">0</strong>
                    </span>
                    <span class="version-badge">
                        ğŸ‘¤ User: <strong id="vUser">0</strong>
                    </span>
                    <span class="version-badge">
                        ğŸ“Œ Actual: <strong id="vActual">0</strong>
                    </span>
                    <span class="changes-pending hidden" id="changesPending">0 nous</span>
                </div>
            </div>
            <div class="header-right">
                <button class="btn btn-primary" id="btnStartSession" title="Iniciar sessiÃ³ User">
                    â–¶ï¸ Iniciar SessiÃ³
                </button>
                <button class="btn btn-secondary" id="btnViewPending" title="Veure canvis pendents">
                    ğŸ‘ï¸ Canvis (<span id="pendingCount">0</span>)
                </button>
                <button class="btn btn-icon" id="btnTheme" title="Canviar tema">
                    ğŸŒ“
                </button>
                <button class="btn btn-icon" id="btnRefresh" title="Refrescar">
                    ğŸ”„
                </button>
            </div>
        </header>
        
        <!-- Sidebar -->
        <aside class="sidebar">
            
            <!-- Accions rÃ pides -->
            <section class="sidebar-section">
                <h3>Accions RÃ pides</h3>
                <button class="btn btn-secondary btn-block btn-small" id="btnExpandAll">
                    ğŸ“‚ Expandir Tot
                </button>
                <button class="btn btn-secondary btn-block btn-small" id="btnCollapseAll">
                    ğŸ“ Contraure Tot
                </button>
            </section>
            
            <!-- Cerca -->
            <section class="sidebar-section">
                <h3>Cerca</h3>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Buscar...">
                    <span class="search-icon">ğŸ”</span>
                </div>
            </section>
            
            <!-- Filtres -->
            <section class="sidebar-section">
                <h3>Filtres</h3>
                
                <label>Estat:</label>
                <select class="form-control" id="filterStatus">
                    <option value="">Tots</option>
                    <option value="blanc">âšª Nou/sense processar</option>
                    <option value="groc">ğŸŸ¡ Treballant activament</option>
                    <option value="gris">ğŸ”˜ Processat perÃ² inactiu</option>
                    <option value="vermell">ğŸ”´ Erroni/bloquejat</option>
                    <option value="blau">ğŸ”µ Usuari ha validat proposta</option>
                    <option value="taronja">ğŸŸ  Claude ha incorporat actualitzaciÃ³</option>
                    <option value="verd">ğŸŸ¢ Completat/consensuat</option>
                </select>
                
                <label>Tipus:</label>
                <select class="form-control" id="filterType">
                    <option value="">Tots</option>
                    <option value="group">ğŸ“ Grup</option>
                    <option value="memo">ğŸ“ Memo</option>
                    <option value="check">â˜‘ï¸ Check</option>
                    <option value="link">ğŸ”— Link</option>
                    <option value="question">â“ Pregunta</option>
                </select>
                
                <label>
                    <input type="checkbox" id="filterNewOnly">
                    NomÃ©s nous (no revisats)
                </label>
            </section>
            
            <!-- EstadÃ­stiques -->
            <section class="sidebar-section">
                <h3>EstadÃ­stiques</h3>
                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-label">Total:</span>
                        <span class="stat-value" id="statTotal">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">En treball:</span>
                        <span class="stat-value" id="statWorking">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Completats:</span>
                        <span class="stat-value" id="statCompleted">0</span>
                    </div>
                </div>
            </section>
            
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            
            <!-- Toolbar -->
            <div class="toolbar">
                <div class="toolbar-group">
                    <button class="btn btn-secondary btn-small" id="btnSave" disabled>
                        ğŸ’¾ Desar
                    </button>
                </div>
                <div class="toolbar-spacer"></div>
                <div class="toolbar-info">
                    <span id="lastUpdate">Carregant...</span>
                </div>
            </div>
            
            <!-- Breadcrumbs Navigation -->
            <div class="breadcrumbs-bar">
                <button class="btn btn-icon btn-small hidden" id="btnNavigateUp" title="Pujar nivell">
                    â¬†ï¸
                </button>
                <div class="breadcrumbs" id="breadcrumbsContainer">
                    <!-- Breadcrumbs es generarÃ  dinÃ micament -->
                </div>
                <button class="btn btn-primary btn-small" id="btnAddEntry" title="Afegir entrada">
                    â• Afegir Entrada
                </button>
            </div>
            
            <!-- Tree Container -->
            <div id="treeContainer" class="tree-container">
                <!-- L'arbre es renderitzarÃ  aquÃ­ -->
            </div>
            
        </main>
        
    </div>
    
    <!-- Modal: Add/Edit Entry -->
    <div class="modal" id="modalEntry">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalEntryTitle">Nova Entrada</h2>
                <button class="modal-close" type="button" id="btnCloseEntry">Ã—</button>
            </div>
            <form id="formEntry">
                <input type="hidden" id="entryId">
                <input type="hidden" id="entryParentId">
                
                <div class="form-group">
                    <label for="entryType">Tipus d'entrada *</label>
                    <select class="form-control" id="entryType" required>
                        <option value="group">ğŸ“ Grup</option>
                        <option value="memo">ğŸ“ Memo</option>
                        <option value="check">â˜‘ï¸ Check</option>
                        <option value="link">ğŸ”— Link</option>
                        <option value="question">â“ Pregunta</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="entryTitle">TÃ­tol *</label>
                    <input type="text" class="form-control" id="entryTitle" required>
                </div>
                
                <div class="form-group" id="groupContent">
                    <label for="entryContent">Contingut</label>
                    <textarea class="form-control" id="entryContent" rows="5"></textarea>
                </div>
                
                <div class="form-group hidden" id="groupUrl">
                    <label for="entryUrl">URL</label>
                    <input type="url" class="form-control" id="entryUrl">
                </div>
                
                <div class="form-group">
                    <label>Estat (color)</label>
                    <div class="color-selector" id="colorSelector">
                        <!-- Colors es generaran dinÃ micament -->
                    </div>
                    <input type="hidden" id="entryColor" value="blanc">
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="btnCancelEntry">
                        CancelÂ·lar
                    </button>
                    <button type="submit" class="btn btn-primary" id="btnSaveEntry">
                        ğŸ’¾ Desar
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal: View Pending Changes -->
    <div class="modal" id="modalPending">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>Canvis Pendents de Revisar</h2>
                <button class="modal-close" type="button" id="btnClosePending">Ã—</button>
            </div>
            <div id="pendingList" class="pending-list">
                <!-- Llista de canvis es generarÃ  aquÃ­ -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="btnCancelPending">
                    Tancar
                </button>
                <button type="button" class="btn btn-primary" id="btnMarkReviewed">
                    âœ… Marcar Tot com Revisat
                </button>
            </div>
        </div>
    </div>
    
    <!-- Scripts - ORDRE IMPORTANT! -->
    <script src="js/config.js"></script>
    <script src="js/state.js"></script>
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/complex-templates.js"></script>
    <script src="js/tree.js"></script>
    <script src="js/app.js"></script>
    
</body>
</html>
